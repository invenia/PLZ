---
include:
  - project: infrastructure/gitlab-ci-helper
    file: /templates/python.yml
  - project: infrastructure/gitlab-ci-helper
    file: /templates/py-check.yml
  - project: infrastructure/gitlab-ci-helper
    file: /templates/teardown.yml

# py-check.yml will include "Code Format Check", and "Version Check"
# teardown.yml will include "Coverage", "Documentation", and "pages"

"Test Python 3.6":
  extends: .test_3_6

"Test Python 3.7":
  extends: .test_3_7

"Upload to PyPiCloud":
  extends: .upload_to_pypicloud

"Test Docker Build (Linux 64-Bit)":
  stage: test
  tags:
    - amzn2
    - docker-build
  before_script:
    - echo "$common_functions" > common && source common
    - enter_python_venv
    - sudo yum -y install gcc git
    - pip install tox
    - docker --version
  script:
    - tox -e docker
